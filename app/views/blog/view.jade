extends layout

block content
    h2.page-header.post-view-header= post.title
    div.post.post-view
        div.post-meta
            span.post-created
                i.fa.fa-calendar &nbsp
                =moment(post.created).format('YYYY-MM-DD')
            span.post-author
                i.fa.fa-user &nbsp
                =post.author.name
            span.post-category
                i.fa.fa-shopping-basket &nbsp
                a(href='/posts/category/'+post.category.name)
                    =post.category.name
            span.post-comment
                i.fa.fa-comment &nbsp
                =post.comments.length || 0
            //- span.post-favorite
            //-     a(href="/posts/favourite/"+post.slug)
            //-         i.fa.fa-star &nbsp
            //-         =post.meta.favorite || 0
            span.post-favorites
                button#favourite
                    i.fa.fa-star &nbsp
                    span.favoriteNode
                        =post.meta.favorite|| 0
        div.post-content
            =post.content
    div.ds-thread(data-thread-key="#{post._id}", data-title="#{post.title}", data-url="http://42.96.159.91:3000/posts/view/#{post.slug}")
block scripts 
    script.
        $(document).ready(function(){
            $('#favourite').click(function(){
                $.ajax({
                url:"/posts/favourite/#{post.slug}",
                type:"GET",
                success:function(){
                    $(".favoriteNode").html(parseInt($(".favoriteNode").html())+1);
                },
                    
                })
            })
        })
    script(type="text/javascript").
       var duoshuoQuery = {short_name:"node-in-abang-blog"};
       (function() {
         var ds = document.createElement('script');
         ds.type = 'text/javascript';ds.async = true;
         ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
         ds.charset = 'UTF-8';
         (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
       })()
